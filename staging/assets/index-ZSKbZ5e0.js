import{_ as C}from"./ProTier-B55JtDlE.js";import{d as S,H as D,u as H,e as L,f as V,r as v,g as B,h as x,a as M,i as w,j as k,_ as z,k as N,l as r,w as h,m as F,n as I,p as P,v as $,V as E,o as U,b as _,q as R}from"./index-3bpbC0lp.js";import{V as W}from"./VSelect-Dw3BF2Yl.js";import"./VChip-DLI4rWZl.js";const q=S({__name:"index",setup(O,{expose:a}){a(),D.setOptions({chart:{styledMode:!0}});const n=H(),e=L(),c=V(()=>n.isDark),d=[{value:"weekly",label:"Last week"},{value:"monthly",label:"Last month"},{value:"yearly",label:"Last year"},{value:"total",label:"Total"}],o=v(e.timeframe),u=v(!1);function i(t,s,l,A=!0){var g;let y=l>=0?"green":"red";A||(y="transparent");const m=p=>p.toFixed(0),j=l>=0?`+${m(l)}%`:`${m(l)}%`;return`
    <div class="custom_card">
      <div class="custom_card-header">${t}</div>
      <span class="custom_card-value">${m(s)}</span>
      <span class="custom_card-subtext" style="color: ${y};">
        ${j} vs ${((g=d.find(p=>p.value===o.value))==null?void 0:g.label)||"N/A"}
      </span>
    </div>
  `}async function f(){w.board("dashboard_free",{gui:{layouts:[{rows:[{cells:[{id:"row-1",layout:{rows:[{cells:[{id:"card-api-calls-free"},{id:"card-customers-free"}]}]}}]}]}]},components:[{type:"HTML",renderTo:"card-api-calls-free",html:i("Free API Calls left this month",e.free_data.left_free_api_calls,0,!1)},{type:"HTML",renderTo:"card-customers-free",html:i("Customers",e.free_data.customer_count_change.current_period_customers,e.free_data.customer_count_change.percent_change)}]}),w.board("dashboard_container",{gui:{layouts:[{rows:[{cells:[{id:"row-1",layout:{rows:[{cells:[{id:"x",layout:{rows:[{id:"row-1-1A",cells:[{id:"card-api-calls"}]},{id:"row-1-1B",cells:[{id:"card-income"}]}]}},{id:"chart-pie"},{id:"chart-line"}]}]}}]},{id:"row-2",cells:[{id:"row-2A"},{id:"row-2B"}]}]}],enabled:!0},components:[{type:"HTML",renderTo:"card-api-calls",html:i("API Calls",e.data.api_calls.current_period_api_calls,e.data.api_calls.percent_change)},{type:"HTML",renderTo:"card-income",html:i("Income",e.data.parking_income.current_period_income,e.data.parking_income.percent_change)},{type:"Highcharts",renderTo:"chart-line",chartOptions:{chart:{type:"line"},title:{text:"Customer Trends"},xAxis:{categories:Object.keys(e.data.customers),title:{text:"Timeframe"}},yAxis:{title:{text:"Number of Customers"}},series:[{type:"line",name:"Customers",data:Object.values(e.data.customers)}]}},{type:"Highcharts",renderTo:"chart-pie",chartOptions:{chart:{type:"pie"},title:{text:"Customer Distribution"},plotOptions:{pie:{innerSize:"50%"}},series:[{type:"pie",name:"Customers",data:Object.keys(e.data.customer_distribution).map((t,s)=>({name:t,y:Number(Object.values(e.data.customer_distribution)[s])}))}]}},{type:"Highcharts",renderTo:"row-2A",chartOptions:{chart:{type:"line"},title:{text:"Average Daily Utilization"},xAxis:{categories:Object.keys(e.data.avg_utilization).length>0?Object.keys(e.data.avg_utilization[Object.keys(e.data.avg_utilization)[0]]):Object.keys(e.data.customers),title:{text:"Date"}},yAxis:{title:{text:"Utilization in %"}},series:Object.keys(e.data.avg_utilization).map(t=>({type:"line",name:t,data:Object.values(e.data.avg_utilization[t])}))}},{type:"Highcharts",renderTo:"row-2B",chartOptions:{chart:{type:"column"},title:{text:"Defect Distribution"},xAxis:{categories:Object.keys(e.data.defect_distribution),title:{text:"Properties"}},yAxis:{min:0,title:{text:"Count"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"gray"}}},legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,borderColor:"#CCC",borderWidth:1,shadow:!1},plotOptions:{column:{stacking:"normal"}},series:Object.values(k.DefectState).filter(t=>typeof t=="number").map(t=>({type:"column",name:k.DefectState[t],data:Object.keys(e.data.defect_distribution).map(s=>e.data.defect_distribution[s][t])}))}}]})}async function T(){e.setTimeframe(o.value),await e.fetchAllData()}B(async()=>{x(()=>e.loading,async()=>{if(!e.loading&&M.currentRoute.value.name==="/[tenantId]/")try{await f()}catch(t){console.error(t)}}),x(c,t=>{document.getElementById("dashboard_free").className=`highcharts-${t?"dark":"light"}`,document.getElementById("dashboard_container").className=`highcharts-${t?"dark":"light"}`},{immediate:!0}),await e.fetchAllData()});const b={appStore:n,monitoringStore:e,isDark:c,filters:d,selectedFilter:o,error:u,createCardHTML:i,initDashBoard:f,onFilterChange:T};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}});function G(O,a,n,e,c,d){const o=C;return U(),N("div",null,[r(F,{density:"comfortable",class:"d-flex align-center pa-1 pl-8 pr-4"},{default:h(()=>[a[1]||(a[1]=_("h1",{class:"text-h5 bold"},"Management Dashboard",-1)),r(R),r(W,{"max-width":"200",density:"comfortable","hide-details":"",modelValue:e.selectedFilter,"onUpdate:modelValue":[a[0]||(a[0]=u=>e.selectedFilter=u),e.onFilterChange],items:e.filters,label:"Select Timeframe","item-title":"label"},null,8,["modelValue"])]),_:1}),r(I,{indeterminate:e.monitoringStore.loading,color:e.error?"error":void 0},null,8,["indeterminate","color"]),P(r(E,null,{default:h(()=>[a[3]||(a[3]=_("div",{id:"dashboard_free"},null,-1)),r(o,null,{default:h(()=>a[2]||(a[2]=[_("div",{id:"dashboard_container",style:{"min-height":"100%"}},null,-1)])),_:1})]),_:1},512),[[$,!e.appStore.authLoading]])])}const Y=z(q,[["render",G],["__file","/home/runner/work/cloud-porsche/cloud-porsche/cloud-dev-ui/src/pages/[tenantId]/index.vue"]]);export{Y as default};
