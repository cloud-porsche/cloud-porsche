import{_ as A}from"./ProTier-D_-wzBL4.js";import{d as C,H as D,u as j,e as V,f as H,r as L,g as B,h as y,a as M,i as v,j as x,_ as z,k as N,l as o,w as p,m as F,n as I,p as w,v as P,V as E,o as $,b as h,q as R,s as U,x as W,T as q}from"./index-CiNuP3ky.js";import{V as G}from"./VSelect-DRBV7XU1.js";import"./VChip-CZvYldw7.js";const J=C({__name:"index",setup(T,{expose:a}){a(),D.setOptions({chart:{styledMode:!0}});const n=j(),e=V(),c=H(()=>n.isDark),d=[{value:"weekly",label:"Last week"},{value:"monthly",label:"Last month"},{value:"yearly",label:"Last year"},{value:"total",label:"Total"}],i=L(e.timeframe);function r(t,s,l,O=!0){var b;let g=l>=0?"green":"red";O||(g="transparent");const u=m=>m.toFixed(0),S=l>=0?`+${u(l)}%`:`${u(l)}%`;return`
    <div class="custom_card">
      <div class="custom_card-header">${t}</div>
      <span class="custom_card-value">${u(s)}</span>
      <span class="custom_card-subtext" style="color: ${g};">
        ${S} vs ${((b=d.find(m=>m.value===i.value))==null?void 0:b.label)||"N/A"}
      </span>
    </div>
  `}async function _(){v.board("dashboard_free",{gui:{layouts:[{rows:[{cells:[{id:"row-1",layout:{rows:[{cells:[{id:"card-api-calls-free"},{id:"card-customers-free"}]}]}}]}]}]},components:[{type:"HTML",renderTo:"card-api-calls-free",html:r("Free API Calls left this month",e.free_data.left_free_api_calls,0,!1)},{type:"HTML",renderTo:"card-customers-free",html:r("Customers",e.free_data.customer_count_change.current_period_customers,e.free_data.customer_count_change.percent_change)}]}),v.board("dashboard_container",{gui:{layouts:[{rows:[{cells:[{id:"row-1",layout:{rows:[{cells:[{id:"x",layout:{rows:[{id:"row-1-1A",cells:[{id:"card-api-calls"}]},{id:"row-1-1B",cells:[{id:"card-income"}]}]}},{id:"chart-pie"},{id:"chart-line"}]}]}}]},{id:"row-2",cells:[{id:"row-2A"},{id:"row-2B"}]}]}],enabled:!0},components:[{type:"HTML",renderTo:"card-api-calls",html:r("API Calls",e.data.api_calls.current_period_api_calls,e.data.api_calls.percent_change)},{type:"HTML",renderTo:"card-income",html:r("Income",e.data.parking_income.current_period_income,e.data.parking_income.percent_change)},{type:"Highcharts",renderTo:"chart-line",chartOptions:{chart:{type:"line"},title:{text:"Customer Trends"},xAxis:{categories:Object.keys(e.data.customers),title:{text:"Timeframe"}},yAxis:{title:{text:"Number of Customers"}},series:[{type:"line",name:"Customers",data:Object.values(e.data.customers)}]}},{type:"Highcharts",renderTo:"chart-pie",chartOptions:{chart:{type:"pie"},title:{text:"Customer Distribution"},plotOptions:{pie:{innerSize:"50%"}},series:[{type:"pie",name:"Customers",data:Object.keys(e.data.customer_distribution).map((t,s)=>({name:t,y:Number(Object.values(e.data.customer_distribution)[s])}))}]}},{type:"Highcharts",renderTo:"row-2A",chartOptions:{chart:{type:"line"},title:{text:"Average Daily Utilization"},xAxis:{categories:Object.keys(e.data.avg_utilization).length>0?Object.keys(e.data.avg_utilization[Object.keys(e.data.avg_utilization)[0]]):Object.keys(e.data.customers),title:{text:"Date"}},yAxis:{title:{text:"Utilization in %"}},series:Object.keys(e.data.avg_utilization).map(t=>({type:"line",name:t,data:Object.values(e.data.avg_utilization[t])}))}},{type:"Highcharts",renderTo:"row-2B",chartOptions:{chart:{type:"column"},title:{text:"Defect Distribution"},xAxis:{categories:Object.keys(e.data.defect_distribution),title:{text:"Properties"}},yAxis:{min:0,title:{text:"Count"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"gray"}}},legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,borderColor:"#CCC",borderWidth:1,shadow:!1},plotOptions:{column:{stacking:"normal"}},series:Object.values(x.DefectState).filter(t=>typeof t=="number").map(t=>({type:"column",name:x.DefectState[t],data:Object.keys(e.data.defect_distribution).map(s=>e.data.defect_distribution[s][t])}))}}]})}async function k(){e.setTimeframe(i.value),await e.fetchAllData()}B(async()=>{y(()=>e.loading,async()=>{if(!e.loading&&M.currentRoute.value.name==="/[tenantId]/")try{await _()}catch(t){console.error(t)}}),y(c,t=>{document.getElementById("dashboard_free").className=`highcharts-${t?"dark":"light"}`,document.getElementById("dashboard_container").className=`highcharts-${t?"dark":"light"}`},{immediate:!0}),await e.fetchAllData()});const f={appStore:n,monitoringStore:e,isDark:c,filters:d,selectedFilter:i,createCardHTML:r,initDashBoard:_,onFilterChange:k};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}});function K(T,a,n,e,c,d){const i=A;return $(),N("div",null,[o(F,{density:"comfortable",class:"d-flex align-center pa-1 pl-8 pr-4"},{default:p(()=>[a[2]||(a[2]=h("h1",{class:"text-h5 bold"},"Management Dashboard",-1)),o(R),w(o(U,{class:"mr-4",icon:"mdi-refresh",onClick:a[0]||(a[0]=r=>e.monitoringStore.fetchAllData()),loading:e.monitoringStore.loading,color:e.monitoringStore.error?"error":void 0},null,8,["loading","color"]),[[q,"Refresh"]]),o(W,{vertical:"",inset:""}),o(G,{class:"pl-4","max-width":"200",density:"comfortable","hide-details":"",modelValue:e.selectedFilter,"onUpdate:modelValue":[a[1]||(a[1]=r=>e.selectedFilter=r),e.onFilterChange],items:e.filters,label:"Select Timeframe","item-title":"label"},null,8,["modelValue"])]),_:1}),o(I,{indeterminate:e.monitoringStore.loading,color:e.monitoringStore.error?"error":void 0},null,8,["indeterminate","color"]),w(o(E,null,{default:p(()=>[a[4]||(a[4]=h("div",{id:"dashboard_free"},null,-1)),o(i,null,{default:p(()=>a[3]||(a[3]=[h("div",{id:"dashboard_container",style:{"min-height":"100%"}},null,-1)])),_:1})]),_:1},512),[[P,!e.appStore.authLoading]])])}const ee=z(J,[["render",K],["__file","/home/runner/work/cloud-porsche/cloud-porsche/cloud-dev-ui/src/pages/[tenantId]/index.vue"]]);export{ee as default};
